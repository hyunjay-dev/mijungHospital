<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="shortcut icon" type="image⁄x-icon" href="img/logo2.png">
    <title>회원가입</title>
    <link rel='stylesheet' href='./CSS/register1.css'>
    <link rel='stylesheet' href='./CSS/default_copy.css'>
    <link rel='stylesheet' href='./CSS/header.css'>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/0.18.0/axios.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/vue"></script>
    <script src="./source/includeHTML.js"></script>
</head>

<body>
    <div class="wrapper">
        <div class='inner-wrapper'>
            <header class="header">
                <!-- 로고 부분 -->
                <div class='header-left'>
                    <a href=' index.html'>
                        <img src='img/logo2.png ' alt='logo '>

                        <span>미정이네<br>
                            <strong>동물병원</strong></span>
                    </a>
                </div>
                <!-- 메뉴 부분 -->
                <div class='header-center '>
                    <ul class=''>
                        <li class=''>
                            <a href='chart.html'>
                                <span>병원소개</span>
                                <!-- <ul class=''>
                        <li class=''><a href=''>나와라</a></li>
                        <li class=''><a href=''>나와라</a></li>
                        <li class=''><a href=''>나와라</a></li>
                    </ul> -->
                            </a>
                        </li>
                        <li class=' '>
                            <a href='index_rev1.html'>
                                <span>진료예약</span>
                            </a>
                        </li>
                        <li class=' '>
                            <a href='boardIndex.html'>
                                <span>Q & A</span>
                            </a>
                        </li>
                    </ul>
                </div>
                <!-- 로그인 부분 -->
                <div class='header-right' id='app'>
                    <ul class=' ' v-if="!isLogin">
                        <li class=' '>
                            <a href='login.html'>
                                <h2>로그인</h2>
                            </a>
                        </li>
                        <li class=' '>
                            <a href='register.html'>
                                <h2>회원가입</h2>
                            </a>
                        </li>
                    </ul>
                    <ul class=' ' v-if="isLogin">
                        <li class=' '>
                            <a href="#" @click="logout">
                                <h2>로그아웃</h2>
                            </a>
                        </li>
                        <li class=' ' v-if="localStorage.getItem('animal_admin') == 0">
                            <a href='mypage.html'>
                                <h2>마이페이지</h2>
                            </a>
                        </li>
                        <li class=' ' v-if="localStorage.getItem('animal_admin') == 1">
                            <a href='Adminpage.html'>
                                <h2>관리자페이지</h2>
                            </a>
                        </li>
                    </ul>
                </div>
            </header>
            <br><br><br>
            <section class='visual'>
                <div class='con'>
                    <div class='slide'>
                        <div class='title'>
                            <span>?</span>
                        </div>
                    </div>
                </div>
                <div id="loginapp">
                    <section class="container">
                        <article class="half">
                            <h1>회원가입</h1>
                            <div class="tabs">

                            </div>
                            <div class="content" id="registerapp">
                                <div class="signin-cont cont">
                                    <form action="#" method="post" enctype="multipart/form-data" @submit.prevent="register">
                                        ID<input type="email" @keyup="idCheck" name="custId" id="custId" v-model="custId" class="inpt" required="required" placeholder="이메일을 입력해주세요">
                                        <span v-if="custIdCheck" style="margin-left:2%; margin-bottom: 10%; color: red;">이미 사용중인 아이디입니다<br></span> Password
                                        <input type="password" name="custPassword1" id="custPassword1" v-model="custPassword1" class="inpt" required="required" placeholder="비밀번호를 입력해주세요"> Confirm Password<input type="password" @keyup="pwCheck" name="custPassword2"
                                            id="custPassword2" v-model="custPassword2" class="inpt" required="required" placeholder="비밀번호 재확인">
                                        <span v-if="!custPwCheck" style="margin-left:2%; margin-bottom: 10%; color: red;">위 비밀번호와 일치하지 않습니다.<br></span> Name
                                        <input type="text" name="custName" id="custName" v-model="custName" class="inpt" required="required" placeholder="이름을 입력해주세요">
                                        <label for="name">Your name</label> Phone Number : ' - ' 없이 입력해주세요<input type="tel" @keyup="phoneCheck" name="custPhone" id="custPhone" v-model="custPhone" class="inpt" required="required" placeholder="핸드폰번호를 입력해주세요">
                                        <span v-if="custPhoneCheck" style="margin-left:2%; margin-bottom: 10%; color: red;">이미 사용중인 전화번호입니다<br></span>
                                        <span v-if="custPhoneHyphenCheck" style="margin-left:2%; margin-bottom: 10%; color: red;">' - '를 제거해주세요<br></span>

                                        <div class="submit-wrap">
                                            <input type="submit" value="Sign up" class="submit">
                                        </div>
                                    </form>
                                </div>
                            </div>
                        </article>
                        <div class="half bg"></div>
                    </section>
                </div>
            </section>
            <!-- <section class='visual'>

                <div class='con'>
                    <div class='slide'>
                        <div class='title'>
                            <span>회원가입</span>
                        </div>
                    </div>
                </div>
                <br><br><br>
                <div id="registerapp">
                    <form action="#" method="POST" @submit.prevent="register" id="login-form">
                        <table>
                            <tr>
                                <th>아이디(이메일)</th>
                                <td><input type="email" name="custId" id="custId" v-model="custId" placeholder="ex) abc@abc.com" @blur="idCheck" /></td>
                                <td class='tabol'><span v-if="custIdCheck">이미 사용중인 아이디입니다</span></td>
                            </tr>
                            <tr>
                                <th>비밀번호</th>
                                <td class='tabol'><input type="password" name="custPassword1" id="custPassword1" v-model="custPassword1" /></td>

                            </tr>
                            <tr>
                                <th>비밀번호 확인</th>
                                <td><input type="password" name="custPassword2" id="custPassword2" v-model="custPassword2" @keyup="pwCheck" /></td>
                                <td class='tabol'><span v-if="!custPwCheck">위 비밀번호와 일치하지 않습니다.</span></td>
                            </tr>
                            <tr>
                                <th>이름</th>
                                <td class='tabol'><input type="text" name="custName" id="custName" v-model="custName" /></td>

                            </tr>
                            <tr>
                                <th>전화번호</th>
                                <td class='tabol'><input type="tel" name="custPhone" id="custPhone" v-model="custPhone"></td>

                            </tr>
                            <tr>
                                <td colspan="2" style="height: 50px; text-align: center;">
                                    <button type="submit" name="button" :disabled="custIdCheck||!custPwCheck" class='button'>회원가입</button>
                                </td>
                                <td></td>
                            </tr>
                        </table>
                    </form>
                </div>
            </section> -->
            <footer include-html='./source/footer.html'>
            </footer>
        </div>
    </div>
    <script>
        let navapp = new Vue({
            el: "#app",
            data: {
                isLogin: false
            },
            mounted() {
                if (localStorage.getItem("animal_login") != null) {
                    this.isLogin = true;
                }
            },
            methods: {
                logout() {
                    let con_logout = confirm("로그아웃 하시겠습니까");
                    if (con_logout) {
                        localStorage.removeItem("info");
                        localStorage.removeItem("animal_name");
                        localStorage.removeItem("animal_login");
                        localStorage.removeItem("animal_admin");
                        localStorage.removeItem("onceRev");
                        location.href = "index.html";
                    }
                }
            }
        });
        let app = new Vue({
            el: '#registerapp',
            data() {
                return {
                    loading: true,
                    errored: false,
                    custId: "",
                    custPassword1: "",
                    custPassword2: "",
                    custName: "",
                    custPhone: "",
                    custIdCheck: false,
                    custPhoneCheck: false,
                    custPwCheck: true,
                    custPhoneHyphenCheck: false
                }
            },

            methods: {
                register() {
                    if (this.custId == "") {
                        alert("아이디를 입력하세요");
                        return;
                    }
                    if (this.custPassword == "") {
                        alert("비밀번호를 입력하세요");
                        return;
                    }
                    if (this.custIdCheck) {
                        return alert("중복된 아이디를 입력하셨습니다.")
                    } else if (this.custPwCheck == false) {
                        return alert("비밀번호를 다시 확인해주세요.")
                    } else if (this.custPhoneCheck) {
                        return alert("이미 가입된 전화번호입니다.")
                    } else if (this.custPhoneHyphenCheck) {
                        return alert("전화번호에 '-'를 제거해주세요.")
                    }
                    axios
                        .post("http://localhost:7000/mijung/register", {
                            custId: this.custId,
                            custPassword: this.custPassword1,
                            custName: this.custName,
                            custPhone: this.custPhone
                        })
                        .then(response => {
                            alert(`${this.custName}님, 가입을 축하드립니다.`);
                            location.href = "index.html"
                        })
                        .catch(error => {
                            console.log(error);
                            this.errored = true
                        })
                        .finally(() => this.loading = false)
                },
                idCheck() {
                    axios
                        .get("http://localhost:7000/mijung/idCheck/" + this.custId)
                        .then(response => (this.custIdCheck = response.data))
                        .catch(error => {
                            console.log(error);
                            this.errored = true
                        })
                        .finally(() => this.empEmpty = false)
                },
                phoneCheck() {
                    if (this.custPhone.indexOf('-') != -1) {
                        this.custPhoneHyphenCheck = true;
                    } else {
                        this.custPhoneHyphenCheck = false;
                    }
                    axios
                        .get("http://localhost:7000/mijung/phoneCheck/" + this.custPhone)
                        .then(response => (this.custPhoneCheck = response.data))
                        .catch(error => {
                            console.log(error);
                            this.errored = true
                        })
                        .finally(() => this.empEmpty = false)
                },
                pwCheck() {
                    if (this.custPassword1 != this.custPassword2) {
                        this.custPwCheck = false;
                    } else {
                        this.custPwCheck = true;
                    }
                }

            }
        });
    </script>
    </div>
</body>
<script>
    includeHTML();
</script>

</html>